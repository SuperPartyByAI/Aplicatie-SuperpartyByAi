import{j as e,a as j}from"./index-ClXGTNqs.js";import{b as o,u as A}from"./react-vendor-BCVUYfxV.js";import"./index-CG1tBJBN.js";import"./firebase-CZFSqwcK.js";const x="https://us-central1-superparty-frontend.cloudfunctions.net/whatsapp";function w(){const[n,m]=o.useState([]),[s,f]=o.useState(!0),[b,c]=o.useState(!1),[a,d]=o.useState(""),[i,l]=o.useState("");o.useEffect(()=>{p();const t=setInterval(()=>{p()},3e3);return()=>clearInterval(t)},[]);const p=async()=>{try{const r=await(await fetch(`${x}/api/whatsapp/accounts`)).json();console.log("ğŸ“± WhatsApp accounts loaded:",r.accounts),r.success&&(m(r.accounts),r.accounts.forEach(u=>{console.log(`Account ${u.name}: status=${u.status}, hasQR=${!!u.qrCode}`)}))}catch(t){console.error("âŒ Error loading accounts:",t)}finally{f(!1)}},h=async()=>{if(!a.trim()){alert("Introdu un nume pentru cont!");return}try{console.log("ğŸ”„ Adding account:",a,"phone:",i);const t=await fetch(`${x}/api/whatsapp/add-account`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,phone:i||void 0})});if(console.log("ğŸ“¡ Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("ğŸ“¦ Response data:",r),r.success)c(!1),d(""),l(""),p(),alert("âœ… Cont adÄƒugat! AÈ™teaptÄƒ QR code"+(i?" È™i pairing code":"")+"...");else throw new Error(r.error||"Eroare necunoscutÄƒ")}catch(t){console.error("âŒ Error adding account:",t),alert("âŒ Eroare la adÄƒugarea contului: "+t.message)}},g=t=>{switch(t){case"connected":return"#10b981";case"qr_ready":return"#f59e0b";case"connecting":return"#3b82f6";default:return"#6b7280"}},y=t=>{switch(t){case"connected":return"âœ… Conectat";case"qr_ready":return"ğŸ“± ScaneazÄƒ QR";case"connecting":return"ğŸ”„ Se conecteazÄƒ...";default:return"â¸ï¸ Deconectat"}};return s?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#9ca3af"},children:"Se Ã®ncarcÄƒ..."}):e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("h2",{style:{margin:0,color:"white"},children:["ğŸ“± Conturi WhatsApp (",n.length,")"]}),e.jsx("button",{onClick:()=>c(!0),style:{padding:"0.75rem 1.5rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600"},children:"+ AdaugÄƒ Cont"})]}),n.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center",background:"#1f2937",borderRadius:"8px",color:"#9ca3af"},children:[e.jsx("p",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:"ğŸ“­ Niciun cont WhatsApp"}),e.jsx("p",{children:"AdaugÄƒ primul cont pentru a Ã®ncepe!"})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"1.5rem"},children:n.map(t=>e.jsxs("div",{style:{background:"#1f2937",borderRadius:"8px",padding:"1.5rem",border:"1px solid #374151"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"1rem"},children:e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"white"},children:t.name}),e.jsx("div",{style:{display:"inline-block",padding:"0.25rem 0.75rem",background:g(t.status)+"20",color:g(t.status),borderRadius:"4px",fontSize:"0.875rem",fontWeight:"600"},children:y(t.status)})]})}),t.phone&&e.jsxs("p",{style:{margin:"0.5rem 0",color:"#9ca3af",fontSize:"0.875rem"},children:["ğŸ“ ",t.phone]}),t.qrCode&&(t.status==="qr_ready"||t.status==="reconnecting")&&e.jsxs("div",{style:{marginTop:"1rem",textAlign:"center"},children:[e.jsx("p",{style:{color:"#f59e0b",fontSize:"0.875rem",marginBottom:"0.5rem",fontWeight:"600"},children:"ğŸ“± ScaneazÄƒ cu WhatsApp:"}),e.jsx("img",{src:t.qrCode,alt:"QR Code",style:{width:"250px",height:"250px",margin:"0 auto",border:"2px solid #374151",borderRadius:"8px",padding:"0.5rem",background:"white"}}),e.jsx("p",{style:{color:"#6b7280",fontSize:"0.75rem",marginTop:"0.5rem"},children:"WhatsApp â†’ Settings â†’ Linked Devices â†’ Link a Device"}),t.pairingCode&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#1e293b",borderRadius:"8px",border:"1px solid #334155"},children:[e.jsx("p",{style:{color:"#94a3b8",fontSize:"0.75rem",marginBottom:"0.5rem"},children:"SAU foloseÈ™te codul de conectare:"}),e.jsx("p",{style:{color:"#10b981",fontSize:"1.5rem",fontWeight:"700",letterSpacing:"0.2em",margin:"0.5rem 0",fontFamily:"monospace"},children:t.pairingCode}),e.jsx("p",{style:{color:"#6b7280",fontSize:"0.7rem",marginTop:"0.5rem"},children:"WhatsApp â†’ Settings â†’ Linked Devices â†’ Link with phone number"})]})]}),t.status==="connected"&&e.jsx("div",{style:{marginTop:"1rem",padding:"1rem",background:"#10b98120",borderRadius:"6px",textAlign:"center"},children:e.jsx("p",{style:{color:"#10b981",margin:0,fontWeight:"600"},children:"âœ… Cont activ È™i funcÈ›ional!"})})]},t.id))}),b&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.75)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"#1f2937",borderRadius:"8px",padding:"2rem",maxWidth:"400px",width:"90%"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem 0",color:"white"},children:"AdaugÄƒ Cont WhatsApp"}),e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#9ca3af",fontSize:"0.875rem"},children:"Nume cont:"}),e.jsx("input",{type:"text",value:a,onChange:t=>d(t.target.value),placeholder:"Ex: SuperParty Account 1",style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"white",marginBottom:"1rem"}}),e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#9ca3af",fontSize:"0.875rem"},children:"NumÄƒr telefon (opÈ›ional, pentru pairing code):"}),e.jsx("input",{type:"tel",value:i,onChange:t=>l(t.target.value),placeholder:"Ex: +40712345678",style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"white",marginBottom:"0.5rem"},onKeyPress:t=>t.key==="Enter"&&h()}),e.jsx("p",{style:{color:"#6b7280",fontSize:"0.7rem",marginBottom:"1.5rem",marginTop:"0.25rem"},children:"ğŸ’¡ DacÄƒ introduci numÄƒrul, vei primi È™i un cod de 8 cifre"}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>{c(!1),d(""),l("")},style:{flex:1,padding:"0.75rem",background:"#374151",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"AnuleazÄƒ"}),e.jsx("button",{onClick:h,style:{flex:1,padding:"0.75rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600"},children:"AdaugÄƒ"})]})]})})]})}function R(){const n=A(),s=j.currentUser?.email==="ursache.andrei1995@gmail.com";return o.useEffect(()=>{if(!s){alert("â›” Acces interzis! Doar administratorul poate accesa aceastÄƒ paginÄƒ."),n("/home");return}},[s,n]),s?e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:"ğŸ’¬ Chat Clienti - WhatsApp"}),e.jsx("p",{className:"page-subtitle",children:"Gestionare conturi WhatsApp cu QR codes"})]}),e.jsx("button",{onClick:()=>n("/home"),className:"btn-secondary",children:"â† Ãnapoi"})]})}),e.jsx(w,{})]}):null}export{R as default};
