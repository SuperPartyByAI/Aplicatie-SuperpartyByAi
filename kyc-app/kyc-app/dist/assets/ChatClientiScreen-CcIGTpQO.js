import{j as e,a as R}from"./index-BdPRXwj2.js";import{u as T,b as n}from"./react-vendor-BCVUYfxV.js";import{J as D}from"./firebase-CZFSqwcK.js";import{l as A}from"./index-CG1tBJBN.js";const x="https://aplicatie-superpartybyai-production.up.railway.app",E=[{id:"1",name:"Ion Popescu",phone:"+40721234567",status:"available",unreadCount:2,lastMessage:Date.now()-3e5,lastMessageText:"BunÄƒ ziua, aÈ™ dori sÄƒ rezerv..."},{id:"2",name:"Maria Ionescu",phone:"+40722345678",status:"available",unreadCount:0,lastMessage:Date.now()-6e5,lastMessageText:"MulÈ›umesc pentru informaÈ›ii!"},{id:"3",name:"Andrei Georgescu",phone:"+40723456789",status:"reserved",unreadCount:1,lastMessage:Date.now()-9e5,lastMessageText:"CÃ¢nd pot veni sÄƒ plÄƒtesc?"},{id:"4",name:"Elena Dumitrescu",phone:"+40724567890",status:"reserved",unreadCount:0,lastMessage:Date.now()-12e5,lastMessageText:"Am fÄƒcut plata"},{id:"5",name:"Mihai Popa",phone:"+40725678901",status:"lost",unreadCount:0,lastMessage:Date.now()-864e5,lastMessageText:"Nu mai sunt interessat"}],C=!1;function P(){const o=T(),[l,w]=n.useState(null),[d,S]=n.useState(!0),c=l?.email==="ursache.andrei1995@gmail.com",[b,u]=n.useState([]),[s,y]=n.useState(null),[i,z]=n.useState("available"),[p,k]=n.useState(""),[N,M]=n.useState(null),[L,v]=n.useState(!1);n.useEffect(()=>{const t=D(R,r=>{w(r),S(!1)});return()=>t()},[]),n.useEffect(()=>{if(d)return;if(!c){console.log("Current user email:",l?.email),console.log("Expected admin email: ursache.andrei1995@gmail.com"),alert(`â›” Acces interzis!

Email-ul tÄƒu: ${l?.email}
Email admin necesar: ursache.andrei1995@gmail.com`),o("/home");return}const t=A(x);return M(t),m(),t.on("whatsapp:message",r=>{console.log("ðŸ’¬ New message received"),m()}),t.on("client:status_updated",r=>{console.log("ðŸ“Š Client status updated:",r),m(),setQrCode(null)}),()=>{t&&t.disconnect()}},[d,c,o]);const m=async()=>{v(!0);try{if(!C){const r=await(await fetch(`${x}/api/clients`)).json();r.success&&u(r.clients)}}catch(t){console.error("Failed to load clients:",t),u(E)}finally{v(!1)}},h=()=>b.filter(t=>t.status===i).filter(t=>{if(!p)return!0;const r=p.toLowerCase();return t.name.toLowerCase().includes(r)||t.phone.toLowerCase().includes(r)}),a=async(t,r)=>{try{(await(await fetch(`${x}/api/clients/${t}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:r})})).json()).success&&(u(f=>f.map(g=>g.id===t?{...g,status:r}:g)),s?.id===t&&y(f=>({...f,status:r})))}catch(j){console.error("Failed to update client status:",j),alert("âŒ Eroare la actualizarea statusului")}};return d?e.jsx("div",{className:"page-container",children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",color:"white"},children:"Se Ã®ncarcÄƒ..."})}):c?e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:"ðŸ’¬ Chat Clienti"}),e.jsxs("p",{className:"page-subtitle",children:[b.length," clienÈ›i"]})]}),e.jsx("button",{onClick:()=>o("/home"),className:"btn-secondary",children:"â† ÃŽnapoi"})]})}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",padding:"0 1rem",marginBottom:"1rem"},children:["available","reserved","lost"].map(t=>e.jsxs("button",{onClick:()=>z(t),style:{padding:"0.75rem 1.5rem",background:i===t?"#3b82f6":"#374151",color:i===t?"white":"#9ca3af",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"0.5rem"},children:[t==="available"&&"âœ… Disponibili",t==="reserved"&&"â³ ÃŽn Rezervare",t==="lost"&&"âŒ PierduÈ›i",e.jsx("span",{style:{background:i===t?"rgba(255,255,255,0.2)":"rgba(156,163,175,0.2)",padding:"0.125rem 0.5rem",borderRadius:"12px",fontSize:"0.75rem"},children:h().length})]},t))}),e.jsxs("div",{style:{display:"flex",gap:"1rem",height:"calc(100vh - 250px)"},children:[e.jsxs("div",{style:{width:"350px",background:"#1f2937",borderRadius:"8px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid #374151"},children:e.jsx("input",{type:"text",placeholder:"ðŸ” CautÄƒ client...",value:p,onChange:t=>k(t.target.value),style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"8px",color:"white",fontSize:"0.875rem"}})}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"0.5rem"},children:h().length===0?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"#9ca3af"},children:[e.jsxs("p",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:[i==="available"&&"âœ…",i==="reserved"&&"â³",i==="lost"&&"âŒ"]}),e.jsx("p",{children:"Niciun client Ã®n aceastÄƒ categorie"})]}):h().map(t=>e.jsxs("div",{onClick:()=>y(t),style:{padding:"1rem",background:s?.id===t.id?"#3b82f6":"#374151",borderRadius:"8px",cursor:"pointer",marginBottom:"0.5rem",transition:"all 0.2s"},onMouseEnter:r=>{s?.id!==t.id&&(r.currentTarget.style.background="#4b5563")},onMouseLeave:r=>{s?.id!==t.id&&(r.currentTarget.style.background="#374151")},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{fontWeight:"600",color:"white"},children:t.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:s?.id===t.id?"#e0e7ff":"#9ca3af"},children:new Date(t.lastMessage).toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:s?.id===t.id?"#e0e7ff":"#9ca3af",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.phone}),t.unreadCount>0&&e.jsxs("div",{style:{marginTop:"0.5rem",display:"inline-block",background:"#ef4444",color:"white",padding:"0.125rem 0.5rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"600"},children:[t.unreadCount," nou",t.unreadCount>1?"e":""]})]},t.id))})]}),e.jsx("div",{style:{flex:1,background:"#1f2937",borderRadius:"8px",display:"flex",flexDirection:"column",overflow:"hidden"},children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid #374151",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"1.125rem"},children:s.name}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:s.phone})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i==="available"&&e.jsx("button",{onClick:()=>a(s.id,"reserved"),style:{padding:"0.5rem 1rem",background:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"â³ MarcheazÄƒ ÃŽn Rezervare"}),i==="reserved"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(s.id,"available"),style:{padding:"0.5rem 1rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"âœ… MarcheazÄƒ Disponibil"}),e.jsx("button",{onClick:()=>a(s.id,"lost"),style:{padding:"0.5rem 1rem",background:"#ef4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"âŒ MarcheazÄƒ Pierdut"})]}),i==="lost"&&e.jsx("button",{onClick:()=>a(s.id,"available"),style:{padding:"0.5rem 1rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"âœ… ReactiveazÄƒ"})]})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",fontSize:"0.875rem",padding:"1rem"},children:["ConversaÈ›ie cu ",s.name]})}),e.jsxs("div",{style:{padding:"1rem",borderTop:"1px solid #374151",display:"flex",gap:"0.5rem"},children:[e.jsx("input",{type:"text",placeholder:"Scrie un mesaj...",style:{flex:1,padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"8px",color:"white",fontSize:"1rem"}}),e.jsx("button",{style:{padding:"0.75rem 1.5rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:"Trimite"})]})]}):e.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",flexDirection:"column",gap:"1rem"},children:[e.jsx("div",{style:{fontSize:"4rem"},children:"ðŸ’¬"}),e.jsx("p",{style:{fontSize:"1.25rem"},children:"SelecteazÄƒ un client"}),e.jsx("p",{style:{fontSize:"0.875rem"},children:"pentru a vedea conversaÈ›ia"})]})})]})]}):null}export{P as default};
