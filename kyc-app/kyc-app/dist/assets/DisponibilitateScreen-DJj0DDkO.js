import{a as z,d as c,j as e}from"./index-BxCQG0pv.js";import{u as T,b as a}from"./react-vendor-BCFq-EBz.js";import{G as M,H as E,I as B,D as U,Q as F,t as G,O as H,u as L}from"./firebase-CZFSqwcK.js";function J(){const C=T(),s=z.currentUser,[p,w]=a.useState([]),[u,h]=a.useState(!0),[A,t]=a.useState(!1),[l,m]=a.useState(""),[o,b]=a.useState(""),[x,j]=a.useState("08:00"),[g,f]=a.useState("22:00"),[v,N]=a.useState("disponibil"),[D,y]=a.useState("");a.useEffect(()=>{d()},[s]);const d=async()=>{if(s){h(!0);try{const i=M(E(c,"disponibilitati"),B("userId","==",s.uid)),S=(await U(i)).docs.map(r=>({id:r.id,...r.data()}));S.sort((r,q)=>new Date(r.dataStart)-new Date(q.dataStart)),w(S)}catch(i){console.error("Error loading disponibilitati:",i)}finally{h(!1)}}},k=async i=>{if(i.preventDefault(),!l||!o){alert("CompleteazÄƒ datele de Ã®nceput È™i sfÃ¢rÈ™it!");return}try{await H(E(c,"disponibilitati"),{userId:s.uid,userEmail:s.email,dataStart:l,dataEnd:o,oraStart:x,oraEnd:g,tipDisponibilitate:v,notita:D,createdAt:L()}),alert("Disponibilitate adÄƒugatÄƒ!"),t(!1),P(),d()}catch(n){console.error("Error adding disponibilitate:",n),alert("Eroare la adÄƒugare!")}},I=async i=>{if(confirm("È˜tergi aceastÄƒ disponibilitate?"))try{await F(G(c,"disponibilitati",i)),alert("Disponibilitate È™tearsÄƒ!"),d()}catch(n){console.error("Error deleting:",n),alert("Eroare la È™tergere!")}},P=()=>{m(""),b(""),j("08:00"),f("22:00"),N("disponibil"),y("")},O=i=>{switch(i){case"disponibil":return"badge-disponibil";case"indisponibil":return"badge-indisponibil";case"preferinta":return"badge-preferinta";default:return"badge-disponibil"}};return e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Disponibilitate"}),e.jsx("p",{className:"page-subtitle",children:"MarcheazÄƒ cÃ¢nd eÈ™ti disponibil pentru evenimente"})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>C("/home"),className:"btn-secondary",children:"â† Ãnapoi"}),e.jsx("button",{onClick:()=>t(!0),className:"btn-refresh",children:"+ AdaugÄƒ Disponibilitate"})]})]})}),u&&e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Se Ã®ncarcÄƒ disponibilitÄƒÈ›ile..."})]}),!u&&e.jsx("div",{className:"disponibilitati-list",children:p.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"Nu ai disponibilitÄƒÈ›i marcate Ã®ncÄƒ."}),e.jsx("button",{onClick:()=>t(!0),className:"btn-refresh",children:"AdaugÄƒ Prima Disponibilitate"})]}):p.map(i=>e.jsxs("div",{className:"disponibilitate-card",children:[e.jsxs("div",{className:"disp-header",children:[e.jsx("div",{children:e.jsxs("span",{className:`badge ${O(i.tipDisponibilitate)}`,children:[i.tipDisponibilitate==="disponibil"&&"âœ“ Disponibil",i.tipDisponibilitate==="indisponibil"&&"âœ— Indisponibil",i.tipDisponibilitate==="preferinta"&&"â˜… PreferinÈ›Äƒ"]})}),e.jsx("button",{onClick:()=>I(i.id),className:"btn-delete-small",children:"ğŸ—‘ï¸"})]}),e.jsxs("div",{className:"disp-body",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Perioada:"})," ",i.dataStart," â†’ ",i.dataEnd]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Interval orar:"})," ",i.oraStart," - ",i.oraEnd]}),i.notita&&e.jsxs("p",{children:[e.jsx("strong",{children:"NotiÈ›Äƒ:"})," ",i.notita]})]})]},i.id))}),A&&e.jsx("div",{className:"modal-overlay",onClick:()=>t(!1),children:e.jsxs("div",{className:"modal-content",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"AdaugÄƒ Disponibilitate"}),e.jsx("button",{onClick:()=>t(!1),className:"btn-close",children:"Ã—"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tip Disponibilitate"}),e.jsxs("select",{value:v,onChange:i=>N(i.target.value),className:"filter-input",children:[e.jsx("option",{value:"disponibil",children:"âœ“ Disponibil"}),e.jsx("option",{value:"indisponibil",children:"âœ— Indisponibil"}),e.jsx("option",{value:"preferinta",children:"â˜… PreferinÈ›Äƒ (doresc sÄƒ lucrez)"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data Start *"}),e.jsx("input",{type:"date",value:l,onChange:i=>m(i.target.value),className:"filter-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data End *"}),e.jsx("input",{type:"date",value:o,onChange:i=>b(i.target.value),className:"filter-input",required:!0})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ora Start"}),e.jsx("input",{type:"time",value:x,onChange:i=>j(i.target.value),className:"filter-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ora End"}),e.jsx("input",{type:"time",value:g,onChange:i=>f(i.target.value),className:"filter-input"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"NotiÈ›Äƒ (opÈ›ional)"}),e.jsx("textarea",{value:D,onChange:i=>y(i.target.value),className:"filter-input",rows:"3",placeholder:"Ex: Prefer evenimente Ã®n BucureÈ™ti"})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",onClick:()=>t(!1),className:"btn-secondary",children:"AnuleazÄƒ"}),e.jsx("button",{type:"submit",className:"btn-refresh",children:"AdaugÄƒ"})]})]})})]})})]})}export{J as default};
