import{j as e,a as f}from"./index-D5X7DQDB.js";import{b as s,u as y}from"./react-vendor-BCVUYfxV.js";import{l as b}from"./index-CG1tBJBN.js";import"./firebase-CZFSqwcK.js";const l="https://us-central1-superparty-frontend.cloudfunctions.net/whatsapp";function j(){const[n,p]=s.useState([]),[o,m]=s.useState(!0),[g,c]=s.useState(!1),[a,d]=s.useState("");s.useEffect(()=>{i();const t=b(l);return t.on("connect",()=>{console.log("âœ… Connected to WhatsApp backend")}),t.on("whatsapp:qr",r=>{console.log("ğŸ“± QR Code received:",r.accountId),i()}),t.on("whatsapp:connected",r=>{console.log("âœ… WhatsApp connected:",r.accountId),i()}),()=>t.disconnect()},[]);const i=async()=>{try{const r=await(await fetch(`${l}/api/whatsapp/accounts`)).json();r.success&&p(r.accounts)}catch(t){console.error("Error loading accounts:",t)}finally{m(!1)}},u=async()=>{if(!a.trim()){alert("Introdu un nume pentru cont!");return}try{console.log("ğŸ”„ Adding account:",a);const t=await fetch(`${l}/api/whatsapp/add-account`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})});if(console.log("ğŸ“¡ Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("ğŸ“¦ Response data:",r),r.success)c(!1),d(""),i(),alert("âœ… Cont adÄƒugat! AÈ™teaptÄƒ QR code...");else throw new Error(r.error||"Eroare necunoscutÄƒ")}catch(t){console.error("âŒ Error adding account:",t),alert("âŒ Eroare la adÄƒugarea contului: "+t.message)}},h=t=>{switch(t){case"connected":return"#10b981";case"qr_ready":return"#f59e0b";case"connecting":return"#3b82f6";default:return"#6b7280"}},x=t=>{switch(t){case"connected":return"âœ… Conectat";case"qr_ready":return"ğŸ“± ScaneazÄƒ QR";case"connecting":return"ğŸ”„ Se conecteazÄƒ...";default:return"â¸ï¸ Deconectat"}};return o?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#9ca3af"},children:"Se Ã®ncarcÄƒ..."}):e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("h2",{style:{margin:0,color:"white"},children:["ğŸ“± Conturi WhatsApp (",n.length,")"]}),e.jsx("button",{onClick:()=>c(!0),style:{padding:"0.75rem 1.5rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600"},children:"+ AdaugÄƒ Cont"})]}),n.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center",background:"#1f2937",borderRadius:"8px",color:"#9ca3af"},children:[e.jsx("p",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:"ğŸ“­ Niciun cont WhatsApp"}),e.jsx("p",{children:"AdaugÄƒ primul cont pentru a Ã®ncepe!"})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"1.5rem"},children:n.map(t=>e.jsxs("div",{style:{background:"#1f2937",borderRadius:"8px",padding:"1.5rem",border:"1px solid #374151"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"1rem"},children:e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"white"},children:t.name}),e.jsx("div",{style:{display:"inline-block",padding:"0.25rem 0.75rem",background:h(t.status)+"20",color:h(t.status),borderRadius:"4px",fontSize:"0.875rem",fontWeight:"600"},children:x(t.status)})]})}),t.phone&&e.jsxs("p",{style:{margin:"0.5rem 0",color:"#9ca3af",fontSize:"0.875rem"},children:["ğŸ“ ",t.phone]}),t.qrCode&&t.status==="qr_ready"&&e.jsxs("div",{style:{marginTop:"1rem",textAlign:"center"},children:[e.jsx("p",{style:{color:"#f59e0b",fontSize:"0.875rem",marginBottom:"0.5rem",fontWeight:"600"},children:"ğŸ“± ScaneazÄƒ cu WhatsApp:"}),e.jsx("img",{src:t.qrCode,alt:"QR Code",style:{width:"250px",height:"250px",margin:"0 auto",border:"2px solid #374151",borderRadius:"8px",padding:"0.5rem",background:"white"}}),e.jsx("p",{style:{color:"#6b7280",fontSize:"0.75rem",marginTop:"0.5rem"},children:"WhatsApp â†’ Settings â†’ Linked Devices â†’ Link a Device"})]}),t.status==="connected"&&e.jsx("div",{style:{marginTop:"1rem",padding:"1rem",background:"#10b98120",borderRadius:"6px",textAlign:"center"},children:e.jsx("p",{style:{color:"#10b981",margin:0,fontWeight:"600"},children:"âœ… Cont activ È™i funcÈ›ional!"})})]},t.id))}),g&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.75)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"#1f2937",borderRadius:"8px",padding:"2rem",maxWidth:"400px",width:"90%"},children:[e.jsx("h3",{style:{margin:"0 0 1.5rem 0",color:"white"},children:"AdaugÄƒ Cont WhatsApp"}),e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#9ca3af",fontSize:"0.875rem"},children:"Nume cont:"}),e.jsx("input",{type:"text",value:a,onChange:t=>d(t.target.value),placeholder:"Ex: SuperParty Account 1",style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"white",marginBottom:"1.5rem"},onKeyPress:t=>t.key==="Enter"&&u()}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>{c(!1),d("")},style:{flex:1,padding:"0.75rem",background:"#374151",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"AnuleazÄƒ"}),e.jsx("button",{onClick:u,style:{flex:1,padding:"0.75rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600"},children:"AdaugÄƒ"})]})]})})]})}function k(){const n=y(),o=f.currentUser?.email==="ursache.andrei1995@gmail.com";return s.useEffect(()=>{if(!o){alert("â›” Acces interzis! Doar administratorul poate accesa aceastÄƒ paginÄƒ."),n("/home");return}},[o,n]),o?e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:"ğŸ’¬ Chat Clienti - WhatsApp"}),e.jsx("p",{className:"page-subtitle",children:"Gestionare conturi WhatsApp cu QR codes"})]}),e.jsx("button",{onClick:()=>n("/home"),className:"btn-secondary",children:"â† Ãnapoi"})]})}),e.jsx(j,{})]}):null}export{k as default};
